{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Example</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>

</head>
<body>
    
    <p id="id"></p>

    <ul>
        {% for i in des %}
            <!-- it is important the data attributes are defined as a pair
             if you define them separately, 1 of the pair will always be undefined  -->
            <!-- <li data-pt-n="{{ i.RepPtN }}">Northings {{ i.RepPtN }}</li> -->
            <!-- <li data-pt-e="{{ i.RepPtE }}">Eastings {{ i.RepPtE }}</li> -->
            <li class="django-data" data-pt-n="{{ i.RepPtN }}" data-pt-e="{{ i.RepPtE }}" hidden name="django-data"></li>
            
        {% endfor %}
    </ul>

    <div id="details"></div>

    <!-- <ul id="points">

    </ul> -->

    <div id="map"></div>

    
    


    <!-- <script src="{% static 'app.js' %}"></script> -->

    <script>
        // let elements = document.querySelectorAll('li');
        // let elements = document.getElementsByName('django-data');
        let elements = document.getElementsByTagName ('li');
        let container = document.getElementById('details');
        let p = document.getElementById('id');

        // code from the video
        elements.forEach(element => {
            element.addEventListener('click', function() {
                addItem(container, element);
            });
        });
        function addItem(container, element) {
            let data = element.dataset;  
            let nameElement = document.createElement('h1');
            let nameText = document.createTextNode(data.ptN);
            let e = document.createTextNode(data.ptE);
            nameElement.appendChild(nameText);
            nameElement.appendChild(e);
            container.append(nameElement);
        }

        // my mapping code
        let map = L.map('map').setView([40.10, -74.022], 15);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        let marker;        
        elements.forEach(element => {
            let data = element.dataset;           
            marker = L.marker([data.ptN, data.ptE]).addTo(map);
        });
    </script>

    <!-- <script data-pt-n="{{ i.RepPtN }}">
        const data = document.currentScript.dataset;
        const pts = data
    </script> -->
    
    <script>
       
    </script>
</body>
</html>